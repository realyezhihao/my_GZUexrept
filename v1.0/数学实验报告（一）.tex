\documentclass{my_GZUexrept}
% 使用下面的命令来设置封面。
\author{吴同学}
\title{结课实验}
\course{数值计算方法}
\department{数学与统计学院}
\major{数学与应用数学}
\teacher{李老师}
\studentID{20210218}
\date{2023年6月26日}

\usepackage{longtable} %正文长表格

\begin{document}
\maketitle
\begin{longtable}[c]{|>{\setlength\parindent{2em}}m{35em}|} \hline
\noindent\textbf{实验目的及要求：}\par
    \begin{enumerate}
            \item 完成实验一.
            \item 完成实验二.
    \end{enumerate}
\\ \hline

\noindent\textbf{实验内容：}\par
    \begin{exercise}[1]
        编写.M文件,利用积分定义法计算
    \[
        \int_1^2\int_2^3 (x^2+y^2) \mathrm{d}x\mathrm{d}y.
    \]
    \end{exercise}

    \begin{exercise}[2]
        编写.M通用文件,利用定义法计算一般10阶矩阵$A_{10\times10}$的逆（不使用inv命令）.
    \end{exercise}
\\ \hline

\noindent\textbf{实验（或算法）原理：}\par
    依据重积分的定义,二重积分可以写为极限
\[
    \lim_{n\rightarrow\infty} \sum_{i=1}^{n} \sum_{j=1}^{n} f(\xi_k,\eta_j)(x_k - x_{k-1})(y_j - y_{j-1}).
\]
在$[1,2]$和$[2,3]$上分别$n$等分,得到分点$\{1,1+\frac{1}{n},\cdots,2\}$和$\{2,2+\frac{1}{n},\cdots,3\}$.原式等价为
\[
    \lim_{n\rightarrow\infty} \sum_{i=1}^{n} \sum_{j=1}^{n} \frac{1}{n^2} [(1+\frac{i}{n})^2 + (2+\frac{j}{n})^2].
\]

    对方阵$A$,若存在方阵$B$使得$AB = BA = I$($I$为单位矩阵),则称$A$可逆,$B$定义为$A$的逆,记为$A^{-1}$.方阵$A$可逆的充要条件是线性方程组
\[
    A\mathbf{x} = \mathbf{0}
\]
有且只有一个解$\mathbf{x} = \mathbf{0}$.

    考虑Gauss-Jordan消元法.对于增广矩阵$\left[ \begin{smallmatrix} A & I\end{smallmatrix}\right]$有
\[
    \begin{bmatrix}A & I\end{bmatrix} \times A^{-1} = \begin{bmatrix}I & A^{-1}\end{bmatrix}.
\]
\\ \hline

\noindent\textbf{实验过程及结果：}\par
    实验一的MATLAB程序源码如下。
    \begin{lstlisting}[language=matlab]
        % 定义法计算二重定积分
        n = 999999;
        syms k;
        F = 1/(n) * ((1+k/n)^2 + (2+k/n)^2);
        S = symsum(F,k,1,n);
        vpa(S)
    \end{lstlisting}

    运行程序输出结果如下。    
    \begin{lstlisting}[language=matlab]
        >> integral_definition
 
        ans =
         
        8.6666706666709991704661708917349
    \end{lstlisting}
    \\ \hline

    实验二的MATLAB程序源码如下。
    \begin{lstlisting}[language=matlab]
        function B = inverse10x10(A0)
        %inverse计算10*10方阵的逆
        %   原理:Gauss-Jordan Elimination.
        B = [A0 eye(10)]; %构造增广矩阵
        for ai=1:9 %化为上三角矩阵
            B = upper(B,ai);
        end
        for ai=1:9 %化为对角阵
            B = lower(B,ai);
            if isnan(B)==1
                break;
            end
        end
        for ai=1:10 %将对角阵单位化
            B(ai,:) = B(ai,:)/B(ai,ai);
        end
        for ai=1:10 %提取逆矩阵
            B(:,1) = [];
        end
        disp B;
        
            function Y = upper(X,n)
            %化为上三角矩阵
                %每处理一列,检验一次方阵可逆性
                P = X(:,n);
                if n>1
                P(1:n-1) = [];
                end
                p = max(P);
                if p == 0
                    Y = NaN(10);
                    return;
                end
    \end{lstlisting}
    \\ \hline
    \noindent（接上页代码）
    \begin{lstlisting}[language=matlab]
                %将第n列中(除去前n-1个数字)最大数所对应的行交换到第n行
                k = X(:,n)==p;
                tmp = X(n,:); X(n,:) = X(k,:); X(k,:) = tmp;
                
                %消元
                for i = n:9
                    X(i+1,:) = X(i+1,:) - X(n,:)*X(i+1,n)/X(n,n);
                end
                Y = X;
                return;
            end
            
            function Y = lower(X,n)
            %化为下三角矩阵
            %   此处的n与upper(X,n)中的参数n不同,
            %   n=1表示对第10列进行处理,以此类推. 
                for i = n:9
                    X(10-i,:) = X(10-i,:) - X(11-n,:)*X(10-i,11-n)/X(11-n,11-n);
                end
                Y = X;
                return;
            end
        
        end
    \end{lstlisting}
    \\ \hline
    运行程序输出结果如下。
    \begin{lstlisting}[language=matlab]
        >> M = randi([1,100],10,10)

        M =
        
            27    79    14    44    65    61    72    25     1    58
             9     8    60    18    56    92    18    25    32    75
            43    40    91     3    22    91    34    16    70    65
            26     1    94    96    78    60    19    96    63    13
            30    23    23    44    23    34    33    94    55    51
            43     1    49    97    38    86    41    82    44    35
            12    19    38    77    90    45    55    73    29    10
            50    15    53     1    86    91     5    18    51    15
            71    27    27    69    41     4    56    37    77    20
            25    18     7    71    32    54    28    19    77    68
        
        >> N = M^-1
    \end{lstlisting}
    \\ \hline
    \noindent（接上页代码）
    \begin{lstlisting}[language=matlab]
        N =
        
            0.0056    0.0087   -0.0113    0.0015    0.0006    0.0078   -0.0203    0.0061    0.0152   -0.0112
            0.0151   -0.0195    0.0048    0.0136    0.0033   -0.0079   -0.0099    0.0033   -0.0108    0.0070
            0.0010    0.0063    0.0047    0.0095   -0.0056   -0.0028   -0.0044   -0.0067    0.0047   -0.0077
            0.0064   -0.0027   -0.0047    0.0106   -0.0079    0.0041   -0.0091   -0.0038   -0.0001    0.0061
            0.0012    0.0094   -0.0092    0.0023   -0.0005   -0.0081    0.0018    0.0049    0.0049   -0.0012
           -0.0018   -0.0105    0.0068   -0.0075   -0.0017    0.0102    0.0066    0.0061   -0.0121    0.0053
           -0.0109    0.0030    0.0120   -0.0218   -0.0034    0.0055    0.0275   -0.0079    0.0054   -0.0055
           -0.0009   -0.0022   -0.0016   -0.0002    0.0129    0.0006    0.0008    0.0016   -0.0038   -0.0046
           -0.0096   -0.0120    0.0105   -0.0047    0.0031   -0.0066    0.0134    0.0025   -0.0052    0.0124
            0.0037    0.0211   -0.0102    0.0031    0.0037   -0.0040   -0.0129   -0.0056    0.0089   -0.0027
        
        >> inverse10x10(M)
        \end{lstlisting}
        \\ \hline
        \noindent（接上页代码）
        \begin{lstlisting}[language=matlab]
        ans =
        
            0.0056    0.0087   -0.0113    0.0015    0.0006    0.0078   -0.0203    0.0061    0.0152   -0.0112
            0.0151   -0.0195    0.0048    0.0136    0.0033   -0.0079   -0.0099    0.0033   -0.0108    0.0070
            0.0010    0.0063    0.0047    0.0095   -0.0056   -0.0028   -0.0044   -0.0067    0.0047   -0.0077
            0.0064   -0.0027   -0.0047    0.0106   -0.0079    0.0041   -0.0091   -0.0038   -0.0001    0.0061
            0.0012    0.0094   -0.0092    0.0023   -0.0005   -0.0081    0.0018    0.0049    0.0049   -0.0012
           -0.0018   -0.0105    0.0068   -0.0075   -0.0017    0.0102    0.0066    0.0061   -0.0121    0.0053
           -0.0109    0.0030    0.0120   -0.0218   -0.0034    0.0055    0.0275   -0.0079    0.0054   -0.0055
           -0.0009   -0.0022   -0.0016   -0.0002    0.0129    0.0006    0.0008    0.0016   -0.0038   -0.0046
           -0.0096   -0.0120    0.0105   -0.0047    0.0031   -0.0066    0.0134    0.0025   -0.0052    0.0124
            0.0037    0.0211   -0.0102    0.0031    0.0037   -0.0040   -0.0129   -0.0056    0.0089   -0.0027
        
        >> N - ans
        \end{lstlisting}
        \\ \hline
        \noindent（接上页代码）
        \begin{lstlisting}[language=matlab]
        ans =
        
           1.0e-16 *
        
            0.0347   -0.0347    0.0520   -0.0043   -0.0596    0.0347    0.0694   -0.0173         0   -0.0867
           -0.0173   -0.0347   -0.0607   -0.0694    0.0781    0.0520    0.0173    0.0304   -0.1041   -0.0607
           -0.0477         0   -0.0087   -0.0520    0.0781    0.0087    0.0694    0.0434   -0.0520   -0.0520
            0.0347    0.0130   -0.0347    0.0347         0   -0.0087   -0.0694    0.0173    0.0133   -0.0173
            0.0260   -0.0520    0.0694    0.0607   -0.0488         0   -0.0195   -0.0347    0.0173    0.0846
           -0.0152         0    0.0173   -0.0087   -0.0195   -0.0173    0.0347   -0.0260    0.0173   -0.0434
           -0.0347   -0.0087    0.0694   -0.0347   -0.0173    0.0173    0.0347   -0.0173    0.0173    0.0694
           -0.0152   -0.0217    0.0260   -0.0111         0   -0.0033    0.0282    0.0087   -0.0173    0.0347
                 0    0.0520   -0.0173   -0.0347    0.0390         0    0.0173   -0.0217   -0.0260         0
            0.0130   -0.0347   -0.0173    0.0564   -0.0043         0   -0.0347    0.0173   -0.0173    0.0173
    \end{lstlisting}
    
    可以看到自编的.M通用文件计算结果,与MATLAB内置求逆矩阵算法的计算结果,两者之间存在极小的误差($\pm1\times10^{-16}$).
\\ \hline

\noindent\textbf{指导教师意见：}\par
\\
\begin{flushright}
    签名：\qquad \qquad \qquad 年\qquad 月\qquad 日
    \vskip -0.72cm
\end{flushright}
\\ \hline
\end{longtable}

\end{document}